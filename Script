#!/bin/bash

read -p "Combien de minutes voulez-vous exécuter le script ? " duree

if ! [[ "$duree" =~ ^[0-9]+$ ]]; then
    echo "Veuillez entrer un nombre valide."
    exit 1
fi

iterations=$((duree / 2))

echo "Simulation d'activité pour $duree minutes..."

for ((i=1; i<=iterations; i++))
do
    powershell -Command "
        Add-Type -AssemblyName System.Windows.Forms
        [System.Windows.Forms.SendKeys]::SendWait('+{F15}')
    "
    echo "Ping $i/$iterations envoyé à Teams."
    sleep 120
done

echo "Terminé."
